MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## OtherShrimps
## Increase biomass by 100x (Buccheister et al., EMAX; Prebal diagnostics)
MAB.rpath.params$model$Biomass[30]<-MAB.rpath.params$model$Biomass[30]*100
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Megabenthos
## Increase biomass by 20x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[21]<-MAB.rpath.params$model$Biomass[21]*20
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
MAB.rpath.params$model$Biomass[20]
## PB changes
## Bluefish
## Increase PB by 2x (Buccheister et al.)
MAB.rpath.params$model$Biomass[9]<-MAB.rpath.params$model$Biomass[9]*2
## PB changes
## Bluefish
## Increase PB by 2x (Buccheister et al.)
MAB.rpath.params$model$Biomass[9]<-MAB.rpath.params$model$Biomass[9]/2
## PB changes
## Bluefish
## Increase PB by 2x (Buccheister et al.)
MAB.rpath.params$model$PB[9]<-MAB.rpath.params$model$PB[9]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Bluefish
## Increase biomass by 2x (Buccheister et al.)
MAB.rpath.params$model$Biomass[9]<-MAB.rpath.params$model$Biomass[9]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## SmFlatfishes
## Increase biomass by 10x (Lucey)
MAB.rpath.params$model$Biomass[39]<-MAB.rpath.params$model$Biomass[39]*10
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## AtlMackerel
## Increase biomass by 16x (Lucey, Buccheister et al.)
MAB.rpath.params$model$Biomass[4]<-MAB.rpath.params$model$Biomass[4]*16
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
save.image("C:/Users/beven/Desktop/MAB-RPath/MAB Rpath - Balancing - July 2022.RData")
## GelZooplankton
## Increase biomass by 1.5x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[13]<-MAB.rpath.params$model$Biomass[13]*1.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## SummerFlounder
## Increase biomass by 10x (Lucey, Buccheister et al.)
MAB.rpath.params$model$Biomass[44]<-MAB.rpath.params$model$Biomass[44]*10
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
save.image("C:/Users/beven/Desktop/MAB-RPath/MAB Rpath - Balancing - July 2022.RData")
## HMS
## Decrease biomass by 0.75x
MAB.rpath.params$model$Biomass[15]<-MAB.rpath.params$model$Biomass[15]*.75
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Sharks
## Increase QB by 1.3x
MAB.rpath.params$model$QB[36]<-MAB.rpath.params$model$QB[36]/1.3
## HMS
## Decrease QB by 2x
MAB.rpath.params$model$QB[15]<-MAB.rpath.params$model$QB[15]/2
## HMS
## Decrease PB by 2x
MAB.rpath.params$model$PB[15]<-MAB.rpath.params$model$PB[15]/2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
save.image("C:/Users/beven/Desktop/MAB-RPath/MAB Rpath - Balancing - July 2022.RData")
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## OceanPout
## Increase biomass by 10x (Lucey)
MAB.rpath.params$model$Biomass[25]<-MAB.rpath.params$model$Biomass[25]*10
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## WinterSkate
## Increase biomass by 5x (Lucey)
MAB.rpath.params$model$Biomass[48]<-MAB.rpath.params$model$Biomass[48]*5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Windowpane
## Increase biomass by 8x (Lucey)
MAB.rpath.params$model$Biomass[46]<-MAB.rpath.params$model$Biomass[46]*8
## SmPelagics
## Increase biomass by 5x (Buccheister)
MAB.rpath.params$model$Biomass[41]<-MAB.rpath.params$model$Biomass[41]*5
## Balance adjustments
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## SmPelagics
## Increase biomass by 8x (Buccheister)
MAB.rpath.params$model$Biomass[41]<-MAB.rpath.params$model$Biomass[41]/5
## SmPelagics
## Increase biomass by 8x (Buccheister)
MAB.rpath.params$model$Biomass[41]<-MAB.rpath.params$model$Biomass[41]*8
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## LittleSkate
## Increase biomass by 2x
MAB.rpath.params$model$Biomass[18]<-MAB.rpath.params$model$Biomass[18]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## LittleSkate
## Increase biomass by 2x
MAB.rpath.params$model$Biomass[18]<-MAB.rpath.params$model$Biomass[18]/2
## LittleSkate
## Increase biomass by 4x (Lucey)
MAB.rpath.params$model$Biomass[18]<-MAB.rpath.params$model$Biomass[18]*4
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## LittleSkate
## Increase biomass by 4x (Lucey)
MAB.rpath.params$model$Biomass[18]<-MAB.rpath.params$model$Biomass[18]/4
## LittleSkate
## Increase biomass by 4x (Lucey)
MAB.rpath.params$model$Biomass[18]<-MAB.rpath.params$model$Biomass[18]*5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Scup
## Increase biomass by 5x (Lucey)
MAB.rpath.params$model$Biomass[34]<-MAB.rpath.params$model$Biomass[34]*5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## WinterFlounder
## Increase biomass by 8x (Lucey)
MAB.rpath.params$model$Biomass[47]<-MAB.rpath.params$model$Biomass[47]*8
## Mesopelagics
## Increase biomass by 1.5x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[22]<-MAB.rpath.params$model$Biomass[22]*1.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Mesopelagics
## Increase biomass by 1.5x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[22]<-MAB.rpath.params$model$Biomass[22]/1.5
## Mesopelagics
## Increase biomass by 2.5x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[22]<-MAB.rpath.params$model$Biomass[22]*2.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## AtlScallop
## Increase biomass by 4x (Lucey)
MAB.rpath.params$model$Biomass[5]<-MAB.rpath.params$model$Biomass[5]*4
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## OtherSkates
## Increase biomass by 3x (Lucey)
MAB.rpath.params$model$Biomass[31]<-MAB.rpath.params$model$Biomass[31]*3
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Odontocetes
## Increase biomass by 1.5x (Lucey)
MAB.rpath.params$model$Biomass[26]<-MAB.rpath.params$model$Biomass[26]*1.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Odontocetes
## Increase biomass by 1.5x (Lucey)
MAB.rpath.params$model$Biomass[26]<-MAB.rpath.params$model$Biomass[26]/1.5
## Odontocetes
## Increase biomass by 1.5x (Lucey)
MAB.rpath.params$model$Biomass[26]<-MAB.rpath.params$model$Biomass[26]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## SilverHake
## Increase biomass by 2x (Lucey)
MAB.rpath.params$model$Biomass[37]<-MAB.rpath.params$model$Biomass[37]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## SilverHake
## Increase biomass by 2x (Lucey)
MAB.rpath.params$model$Biomass[37]<-MAB.rpath.params$model$Biomass[37]/2
## SilverHake
## Increase biomass by 3x (Lucey)
MAB.rpath.params$model$Biomass[37]<-MAB.rpath.params$model$Biomass[37]*3
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## Goosefish
## Increase biomass by 2.5x (Okey)
MAB.rpath.params$model$Biomass[14]<-MAB.rpath.params$model$Biomass[14]*2.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## AmShad
## Increase biomass by 1.2x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[2]<-MAB.rpath.params$model$Biomass[2]*1.2
## Fourspot
## Increase biomass by 1.5x (Lucey)
MAB.rpath.params$model$Biomass[12]<-MAB.rpath.params$model$Biomass[12]*1.5
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
## AmShad
## Increase biomass by 1.2x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[2]<-MAB.rpath.params$model$Biomass[2]/1.2
## AmShad
## Increase biomass by 2x (Prebal diagnostics)
MAB.rpath.params$model$Biomass[2]<-MAB.rpath.params$model$Biomass[2]*2
MAB.rpath<-rpath(MAB.rpath.params,eco.name='Mid-Atlantic Bight')
MAB.rpath
source("MAB_prebal.R")
EE<-MAB.rpath$EE
EE[order(EE)]
save.image("C:/Users/beven/Desktop/MAB-RPath/MAB Rpath - Balancing - July 2022.RData")
save.image("C:/Users/beven/Desktop/MAB-RPath/MAB Rpath - Balancing - July 2022.RData")
## Trophic level/Log biomass
trophic.lvl<-as.data.frame(MAB.rpath$TL[1:49])
trophic.lvl<-trophic.lvl[,1]
log.biomass<-log10(pb.table$Biomass)
prebal<-as.data.frame(cbind(trophic.lvl,log.biomass))
row.names(prebal)<-pb.table$RPATH
colnames(prebal)<-c("TL","LogB")
## Select model groups only
prebal<-prebal[1:49,]
## Run linear model
linear.model<-lm(log.biomass~trophic.lvl,data=prebal)
summary(linear.model)
plot(log.biomass~trophic.lvl,data=prebal,pch=1,cex=0.001)
abline(linear.model)
text(log.biomass~trophic.lvl,data=prebal,labels=rownames(prebal),cex=0.5,font=2)
setwd("C:/Users/beven/Desktop/MAB-Rpath")
## Load libraries, packages and functions
library(Rpath); library(ggrepel); library(ggplot2); library(grid); library(gridExtra); library(data.table)
#Set up scenario object and run baseline simulation
MAB.scenario<-rsim.scenario(MAB.rpath,MAB.rpath.params,1:50)
MAB.initial<-rsim.run(MAB.scenario, method = 'AB',years=1)
MAB.output<-copy(MAB.initial)
#####
#Baseline scenario
Spiny.baseline<-MAB.scenario
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-2.6)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 9:11,bymonth = T,value=-2.6)
for (i in 0:49){
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-2.6)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+9):((i*12)+11),bymonth = T,value=2.6)
}
#Increased migration scenario
Spiny.increased<-MAB.scenario
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-3.3)
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month = 9:11,bymonth = T,value=3.3)
for (i in 0:49){
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-3.3)
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+9):((i*12)+11),bymonth = T,value=3.3)
}
#Extended migration scenario
Spiny.extended<-MAB.scenario
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-2.6)
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=2.6)
for (i in 0:49){
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-2.6)
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=2.6)
}
#Combined migration scenario
Spiny.combined<-MAB.scenario
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=3.3)
for (i in 0:49){
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=3.3)
}
write.csv(Spiny.increased$forcing$ForcedMigrate,file="Check_forcing_spiny.csv")
#Calculate 50th year biomass
Spiny.baseline.50<-rsim.run(Spiny.baseline,method='AB',50)
Spiny.increased.50<-rsim.run(Spiny.increased,method='AB',50)
Spiny.extended.50<-rsim.run(Spiny.extended,method='AB',50)
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',50)
#Create table relative to baseline
Spiny.results<-as.data.frame(Spiny.baseline.50$end_state$Biomass[2:51],row.names=MAB.groups$RPATH)
Spiny.results<-cbind(Spiny.results,Spiny.increased.50$end_state$Biomass[2:51])
Spiny.results<-cbind(Spiny.results,Spiny.extended.50$end_state$Biomass[2:51])
Spiny.results<-cbind(Spiny.results,Spiny.combined.50$end_state$Biomass[2:51])
colnames(Spiny.results)<-c("Baseline","Increased","Extended","Combined")
Spiny.results$Rel.bas<-Spiny.results$Baseline/Spiny.results$Baseline
Spiny.results$Rel.inc<-Spiny.results$Increased/Spiny.results$Baseline
Spiny.results$Rel.ext<-Spiny.results$Extended/Spiny.results$Baseline
Spiny.results$Rel.com<-Spiny.results$Combined/Spiny.results$Baseline
#Update table to show change
Spiny.results$Rel.bas<-(1-Spiny.results$Rel.bas)*-1
Spiny.results$Rel.inc<-(1-Spiny.results$Rel.inc)*-1
Spiny.results$Rel.ext<-(1-Spiny.results$Rel.ext)*-1
Spiny.results$Rel.com<-(1-Spiny.results$Rel.com)*-1
## Export Spiny results
write.csv(Spiny.results, file = "Spiny_results_fixed.csv")
Spiny.baseline<-MAB.scenario
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-2.6)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 9:11,bymonth = T,value=2.6)
for (i in 0:49){
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-2.6)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+9):((i*12)+11),bymonth = T,value=2.6)
}
#Increased migration scenario
Spiny.increased<-MAB.scenario
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-3.3)
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month = 9:11,bymonth = T,value=3.3)
for (i in 0:49){
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-3.3)
Spiny.increased<-adjust.forcing(Spiny.increased,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+9):((i*12)+11),bymonth = T,value=3.3)
}
#Extended migration scenario
Spiny.extended<-MAB.scenario
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-2.6)
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=2.6)
for (i in 0:49){
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-2.6)
Spiny.extended<-adjust.forcing(Spiny.extended,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=2.6)
}
#Combined migration scenario
Spiny.combined<-MAB.scenario
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=3.3)
for (i in 0:49){
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=3.3)
}
write.csv(Spiny.increased$forcing$ForcedMigrate,file="Check_forcing_spiny.csv")
Spiny.baseline.50<-rsim.run(Spiny.baseline,method='AB',years = 1:50)
Spiny.increased.50<-rsim.run(Spiny.increased,method='AB',years = 1:50)
Spiny.extended.50<-rsim.run(Spiny.extended,method='AB',years = 1:50)
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',years = 1:50)
Spiny.results<-as.data.frame(Spiny.baseline.50$end_state$Biomass[2:51],row.names=MAB.groups$RPATH)
Spiny.results<-cbind(Spiny.results,Spiny.increased.50$end_state$Biomass[2:51])
Spiny.results<-cbind(Spiny.results,Spiny.extended.50$end_state$Biomass[2:51])
Spiny.results<-cbind(Spiny.results,Spiny.combined.50$end_state$Biomass[2:51])
colnames(Spiny.results)<-c("Baseline","Increased","Extended","Combined")
Spiny.results$Rel.bas<-Spiny.results$Baseline/Spiny.results$Baseline
Spiny.results$Rel.inc<-Spiny.results$Increased/Spiny.results$Baseline
Spiny.results$Rel.ext<-Spiny.results$Extended/Spiny.results$Baseline
Spiny.results$Rel.com<-Spiny.results$Combined/Spiny.results$Baseline
#Update table to show change
Spiny.results$Rel.bas<-(1-Spiny.results$Rel.bas)*-1
Spiny.results$Rel.inc<-(1-Spiny.results$Rel.inc)*-1
Spiny.results$Rel.ext<-(1-Spiny.results$Rel.ext)*-1
Spiny.results$Rel.com<-(1-Spiny.results$Rel.com)*-1
## Spiny dogfish
# Spiny increased
Plot_spiny_inc<-data.frame(Rpath = rownames(Spiny.results),Rel.biomass = Spiny.results$Rel.inc)
pdf("spiny_increased_draft.pdf",width = 8,height = 7) ## Changes per plot
sp_inc_all_plot<-ggplot(Plot_spiny_inc[-43,], aes(x = Rpath, y = Rel.biomass)) + ## Change per species
geom_bar(stat="identity") +
coord_flip() +
theme_bw() +
labs (y = bquote("Relative biomass"), x = 'Functional group', title = 'Spiny dogfish - Increased biomass - All species') +
theme(plot.title=element_text(size = 18,face = 'bold',hjust = 0.5), axis.title=element_text(size = 16, face = 'bold'), axis.text= element_text(color = 'black', size = 10))
dev.off()
par(mar=c(9,4,4,4))
plot(Spiny.results$Rel.bas[-43],pch=16,cex=1.5,xlab="",ylab="Relative Biomass",
xaxt="n",ylim=c(0.999,1.006))
axis(1, at = seq(1, 49, by = 1), labels = rownames(Spiny.results[-43,]),las=2)
points(Spiny.results$Rel.inc[-43],pch=16,cex=1.5,col="#785EF0") #purple
points(Spiny.results$Rel.ext[-43],pch=16,cex=1.5,col="#DC267F") # pink
points(Spiny.results$Rel.com[-43],pch=16,cex=1.5,col="#FE6100") #orange
View(Spiny.results)
Spiny.results
Spiny.baseline.50$out_Biomass
Spiny.baseline.50$annual_Biomass
rsim.plot(Spiny.baseline.50, spname = 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.increased.50, spname = 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.extended.50, spname = 'SpinyDogfish', indplot = T)
?rsim.plot
rsim.plot(Spiny.combined.50, spname = 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'AtlMackerel', indplot = T)
rsim.plot(Spiny.baseline.50, spname = 'AtlMackerel', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'AtlMackerel', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'AtlMackerel', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'AtlMackerel', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'SmoothDogfish', indplot = T)
rsim.plot(Spiny.baseline.50, spname = 'SmoothDogfish', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'SmoothDogfish', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'SmoothDogfish', indplot = T)
Spiny.combined<-MAB.scenario
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=.33)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=-.33)
for (i in 0:49){
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=.33)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=-.33)
}
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',years = 1:50)
rsim.plot(Spiny.combined.50, spname = 'SmoothDogfish', indplot = T)
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',years = 1:50)
rsim.plot(Spiny.combined.50, spname = 'SmoothDogfish', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.combined.50, spname = 'AtlMackerel', indplot = T)
write.csv(Spiny.baseline.50, file = "Spiny_baseline_corrected.csv")
write.Rpath(Spiny.baseline.50, file = "Spiny_baseline_corrected.csv")
write.csv(Spiny.baseline.50$annual_Biomass, file = "Spiny_baseline_annual_corrected.csv")
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',years = 1:50)
rsim.plot(Spiny.combined.50, spname = 'SpinyDogfish', indplot =T)
Spiny.combined<-MAB.scenario
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=3.3)
for (i in 0:49){
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=-3.3)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=3.3)
}
rsim.plot(Spiny.baseline.50, spname = 'SpinyDogfish', indplot =T)
rsim.plot(Spiny.combined.50, spname = 'SpinyDogfish', indplot =T)
write.csv(Spiny.combined.50$annual_Biomass, file = "Spiny_combined_annual_corrected.csv")
write.csv(Spiny.combined.50$out_Biomass, file = "Spiny_combined_monthly_corrected.csv")
write.csv(Spiny.baseline.50$out_Biomass, file = "Spiny_baseline_monthly_corrected.csv")
Spiny.baseline<-MAB.scenario
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=.26)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month = 9:11,bymonth = T,value=-.26)
for (i in 0:49){
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=.26)
Spiny.baseline<-adjust.forcing(Spiny.baseline,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+9):((i*12)+11),bymonth = T,value=-.26)
}
Spiny.combined<-MAB.scenario
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 3:5,bymonth = T,value=.33)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month = 10:12,bymonth = T,value=-.33)
for (i in 0:49){
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+3):((i*12)+5),bymonth = T,value=.33)
Spiny.combined<-adjust.forcing(Spiny.combined,'ForcedMigrate','SpinyDogfish',sim.month =((i*12)+10):((i*12)+12),bymonth = T,value=-.33)
}
#Calculate 50th year biomass
Spiny.baseline.50<-rsim.run(Spiny.baseline,method='AB',years = 1:50)
Spiny.combined.50<-rsim.run(Spiny.combined,method='AB',years = 1:50)
rsim.plot(Spiny.baseline.50, 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.combined.50, 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.baseline.50, 'SpinyDogfish', indplot = T)
rsim.plot(Spiny.combined.50, 'SpinyDogfish', indplot = T)
write.csv(Spiny.combined.50$out_Biomass, file = "Spiny_combined_monthly.csv")
write.csv(Spiny.baseline.50$out_Biomass, file = "Spiny_baseline_monthly.csv")
write.csv(Spiny.baseline.50$annual_Biomass, file = "Spiny_baseline_annual.csv")
write.csv(Spiny.combined.50$annual_Biomass, file = "Spiny_combined_annual.csv")
